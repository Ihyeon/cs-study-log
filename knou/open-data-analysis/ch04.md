# Chapter 04 - 데이터 전처리
## 📅 2025-10-12
### 1. 데이터 전처리의 필요성
#### GIGO(Garbage In, Garbage Out)
- 잘못되거나 부정확한 데이터를 입력하면, 어떤 정교한 분석 기법을 적용하더라도 잘못된 결과가 출력된다
#### 데이터 전처리
- 데이터 분석에 앞서 원시 데이터(raw data)를 정제하고 변환하여 분석에 적합한 형태로 만드는 일련의 작업
- 데이터 분석의 전 단계에서 수행되며, 데이터의 정확성과 신뢰성을 확보
- 단계
  1. 측정: 다양한 측정 요소들을 활용하여 데이터의 구조와 특징을 정량적으로 파악
  2. 정제: 불완전성을 보완하고, 이상치를 탐지 및 완화하며, 데이터 간의 불일치성을 수정하는 일련의 과정
     - 결측치(missing values) 처리: 데이터셋 내에 특정 관측값이 누락되어 있는 상태
     - 이상치(outlier) 처리: 데이터에 포함된 불규칙한 변동이나 오류를 의미
  3. 통합: 서로 다른 데이터 저장소로부터 데이터를 결합, 하나의 일관된 데이터 집합을 구축하는 작업으로 중복과 불일치를 제거
  4. 축소: 방대한 데이터를 효율적으로 처리하기 위해 데이터의 크기를 줄이면서도 중요한 정보를 보존하는 과정
  5. 변환: 데이터의 구조나 값을 규칙에 따라 변환하여 분석이 효율적으로 수행되도록 지원

```python
import pandas as pd
from sklearn.cluster import KMeans

data = {
    '나이': [25, 30, 22, 35, 40, 50, 28, 33, 45, 55],
    '소득': [3000, 4000, 2800, 5000, 6000, 7000, 3200, 4500, 6200, 7200]
}

df = pd.DataFrame(data)
kmeans = KMeans(n_clusters = 3, random_state = 42)
df['군집'] = kmeans.fit_predict(df[['나이', '소득']])

# print(df)
```

### 2. Pandas를 이용한 데이터 측정
#### 데이터 측정
- 데이터의 형태, 값의 분포, 평균이나 중앙값 같은 대표값 등 데이터의 특성과 구조를 파악하는 과정
- pandas 라이브러리: 데이터의 저장 뿐 아니라 다양한 통계량 계산을 위한 기능 제공, 데이터의 상태를 요약하는 describe(), info() 메서드 사용
- 데이터 측정 요소
  - 기준: 전체/레코드/그룹 별 측정
  - 요약 통계 지표: 데이터의 특징을 간단히 정리/이해
  - 기타 통계 지표: 데이터의 분포를 파악
#### 요약 통계 지표
| 구분 | 지표 | 설명 |
| :--- | :--- | :--- |
| **중심 경향** | 평균 | 모든 값을 더한 후 개수로 나눈 값으로, 데이터의 대표성을 나타냄. 이상치에 민감 |
| | 중앙값 | 데이터를 크기순으로 정렬했을 때 한가운데 위치한 값으로, 이상치의 영향을 덜 받음 |
| | 최빈값 | 데이터에서 가장 자주 출현하는 값으로, 범주형 데이터 분석에 유용 |
| **분산 정도** | 분산 | 각 데이터 값이 평균에서 얼마나 떨어져 있는지를 제곱하여 평균 낸 값 |
| | 표준편차 | 분산의 제곱근으로, 데이터의 흩어진 정도를 원래 단위로 표현해 직관적 |
| | 범위 | 최댓값에서 최솟값을 뺀 값으로, 데이터의 전체 분포 폭을 파악하는 데 유용 |
| | 사분위수 | 하위 25%(Q1), 50%(Q2, 중앙값), 75%(Q3) 지점을 나타내며 데이터 분포를 시각적으로 이해하는 데 활용 |
| | 사분위 범위(IQR) | Q3에서 Q1을 뺀 값으로, 중앙 50% 구간의 범위를 나타내며 이상치 탐지에 활용 |
#### 요약 통계 지표
| 지표 | 설명 |
| :--- | :--- |
| **합계** | 모든 데이터 값을 더한 값으로, 데이터 총합을 빠르게 확인할 때 사용 |
| **개수** | 데이터 항목 수를 나타내며, 결측치 여부 및 데이터 완전성 점검에 유용 |
| **최댓값** | 데이터 집합에서 가장 큰 값으로, 데이터의 상한 경계를 확인하는 데 도움이 됨 |
| **최솟값** | 데이터 집합에서 가장 작은 값으로, 데이터의 하한 경계를 확인하는 데 도움이 됨 |
| **왜도** | 데이터 분포가 평균을 중심으로 대칭적인지, 한쪽으로 치우쳤는지를 나타내는 지표 |
| **첨도** | 데이터 분포의 뾰족한 정도를 측정하며, 이상치의 빈도를 파악하는 데 유용 |
#### describe() 메서드
| 데이터 유형 | 제공 통계량 | 설명 |
| :--- | :--- | :--- |
| **수치형 데이터** | count | 데이터 개수 (결측치 제외) |
| | mean | 평균 |
| | std | 표준편차 |
| | min | 최솟값 |
| | 25% | 제1사분위수(Q1), 하위 25% 위치값 |
| | 50% | 제2사분위수(Q2), 중앙값(median), 하위 50% 위치값 |
| | 75% | 제3사분위수(Q3), 하위 75% 위치값 |
| | max | 최댓값 |
| **범주형 데이터** | count | 데이터 개수 (결측치 제외) |
| | unique | 고유값(unique) 개수 |
| | top | 최빈값 |
| | freq | 최빈값의 빈도 |

```python
import pandas as pd
import numpy as np

data = {
    'name': ['김민수', '이지영', '박준호', '최서연', '정도윤'], 
    'age': [25, 30, 28, 22, 35],
    'city': ['서울', '부산', '인천', '서울', '대전'],
    'score': [90, 85, 95, 80, np.nan]
}
df = pd.DataFrame(data)

print(df.describe())
print(df.describe(include=[np.number]))
print(df.describe(include=['object']))
```
### 3. 실습
```python
import pandas as pd
import numpy as np

data = {
    'name': ['김민수', '이지영', '박준호', '최서연', '정도윤'],
    'age': [25, 30, 28, 22, 35],
    'city': ['서울', '부산', '인천', '서울', '대전'],
    'score': [90, 85, 95, 80, np.nan]
}
df = pd.DataFrame(data)

# 데이터 측정
df.describe()

# 모든 데이터 타입 측정
df.describe(include='all')

# 수치형 데이터 측정
df.describe(include=[np.number])

# 범주형 데이터 측정
df.describe(include=['object'])

# 특정 열 분석
df['score'].describe()

data = {
    "이름": ["김철수", "이영희", "박민수", "최지훈", "정소희"],
    "학년": [1, 2, 3, 4, 2],
    "학점": [4.2, 3.8, 4.5, 3.9, 3.5],
    "학과": ["컴퓨터공학", "경영학", "전자공학", "의학", "심리학"],
    "동아리": ["프로그래밍", "독서토론", "로봇공학", "봉사활동", "음악감상"]
}
df = pd.DataFrame(data)

# 특정 열 선택
df['이름']
df[['이름', '학과', '학점']]

# DataFrame 열순서 변경
reordered_cols = df[['학과', '이름', '학년', '학점', '동아리']]

# DataFrame 열이름 변경
df_renamed = df.rename(columns={'이름':'학생명', '학점':'평점', '동아리':'과외활동'})

data = {
    "이름": ["김철수", "이영희", "박민수", "최지훈", "정소희"],
    "학년": [1, 2, 3, 4, 2],
    "학점": [4.2, 3.8, 4.5, 3.9, 3.5],
    "학과": ["컴퓨터공학", "경영학", "전자공학", "의학", "심리학"],
    "동아리": ["프로그래밍", "독서토론", "로봇공학", "봉사활동", "음악감상"]
}

#DataFrame 인덱스 지정
df = pd.DataFrame(data)
df = df.set_index('이름')

#DataFrame 행 선택
df.loc['김철수']
df.loc[['김철수', '이영희']]
df.loc['김철수':'박민수']

#DataFrame 위치 기반 행 선택
df.iloc[1]
df.iloc[[2,3]]
df.iloc[1:3]

#DataFrame 조건 기반 선택
df.loc[[True, False, True, False, False]]
df.loc[df['학점'] >= 4.0]
df[df['학년'] == 2]
df[(df['학년'] == 2) & (df['학점'] >= 3.7)]

data = {
    "이름": ["김철수", "이영희", "박민수", "최지훈", "정소희"],
    "학년": [1, 2, 3, 4, 2],
    "학점": [4.2, 3.8, 4.5, 3.9, 3.5],
    "학과": ["컴퓨터공학", "경영학", "전자공학", "의학", "심리학"],
    "동아리": ["프로그래밍", "독서토론", "로봇공학", "봉사활동", "음악감상"]
}

#DataFrame 인덱스 지정
df = pd.DataFrame(data).set_index('이름')
df

#DataFrame 단일 열 오름차순, 내림차순 정렬
df.sort_values(by='학점')
df.sort_values(by='학점', ascending=False)

#DataFrame 복수 열 오름차순, 내림차순 정렬
df.sort_values(by=['학년', '학점'], ascending=[True, False])

#DataFrame 인덱스 기분 오른차순, 내림차순 정렬
df.sort_index()
df.sort_index(ascending=False)
```
