# Chapter 04 - CPU의 작동 원리
## 📅 2025-08-11
### ALU와 제어장치
- ALU: 레지스터로부터 피연산자를 받아들이고, 제어장치로부터 수행할 연산을 알려주는 제어 신호를 받아들임
- 플래그: ALU가 연산한 결괏값과 함께 내보내는 추가적인 상태 정보로 **플래그 레지스터**에 저장됨
  - 부호 플래그: 연산한 결과의 부호를 나타냄 (1 → 음수, 0 → 음수)
  - 제로 플래그: 연산 결과가 0인지의 여부를 나타냄 (1 → 0, 0 → 0이 아님)
  - 캐리 플래그: 연산 결과 올림수나 빌림수가 나타냈는지를 나타냄 (1 → 나타남, 0 → 나타나지 않음)
  - 오버플로우(*연산 결과가 연산 결과를 담을 레지스터보다 큰 상황) 플래그: 오버플로우의 발생 여부를 나타냄 (1 → 발생, 0 → 발생하지 않음)
  - 인터럽트 플래그: 인터럽트가 가능한지의 여부를 나타냄 (1 → 가능, 0 → 불가능)
  - 슈퍼바이저 플래그: 커널/사용자 모드 실행 여부를 나타냄 (1 → 커널 모드, 0 → 사용자 모드)
- 제어장치: 제어 신호를 내보내고 명령어를 해석하는 부품
- 제어 신호: 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호
- 제어 장치가 받아들이는 정보
  - 클럭 신호: 클럭이란 컴퓨터의 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위
  - 현재 수행할 명령어: 명령어 레지스터로부터 명령어를 받아들이고 해석한 뒤, 제어 신호를 발생시킴
  - 플래그
  - 제어 신호: 제어 버스에서 전달됨
- 제어 장치가 내보내는 정보
  - CPU 외부에 전달하는 제어 신호
    - 메모리에 전달하는 제어 신호
    - 입출력 장치에 전달하는 제어 신호
  - CPU 내부에 전달하는 제어 신호
    - ALU에 전달하는 제어 신호: 수행할 연산 지시
    - 레지스터에 전달하는 제어 신호: 레지스터 간에 데이터를 이동시키거나 레지스터에 저장된 명령어를 해석

### 레지스터
```레지스터의 종류```
1. 프로그램 카운터(명령어 포인터): 메모리에서 가져올 명령어의 주소를 저장하는 레지스터
2. 명령어 레지스터: 방금 메모리에서 읽어들인 명령어를 저장하는 레지스터
3. 메모리 주소 레지스터: 메모리의 주소를 저장하는 레지스터
4. 메모리 버퍼 레지스터(메모리 데이터 레지스터): 메모리와 주고받을 값(데이터와 명령어)을 저장하는 레지스터
5. 범용 레지스터: 다양하고 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터
6. 플래그 레지스터: 연산 결과 또는 CPU 상태에 대한 부가적인 정보를 저장하는 레지스터
7. 스택 포인터: 스택의 꼭대기를 가리키는 레지스터
8. 베이스 레지스터

```특정 레지스터를 이용한 주소 지정 방식```
1. 스택 주소 지정 방식: 스택과 스택 포인터를 이용한 주소 지정 방식
2. 변위 주소 지정 방식: 오퍼랜드 필드의 값(변위)와 특정 레지스터의 값을 더하여 유효 주소를 얻어내는 주소 지정 방식
   - 상대 주소 지정 방식: 오퍼랜드와 프로그램 카운터의 값을 더하여 유효주소를 얻는 방식
   - 베이스 레지스터 주소 지정 방식: 오퍼랜드와 베이스 레지스터의 값을 더하여 유효 주소를 얻는 방식
  
### 명령어 사이클과 인터럽트
- 명령어 사이클: 하나의 명령어를 처리하는 정형화된 흐름
  - 인출 사이클: 메모리에 있는 명령어를 CPU로 가지고 오는 단계
  - 간접 사이클: 메모리 접근이 더 필요한 경우 추가되는 단계
  - 실행 사이클: CPU로 가져온 명령어를 실행하는 단계
  - 인터럽트 사이클
- 인터럽트: 정해진 흐름에 따라 명령어를 처리해 나가는 과정에서 흐름이 끊어지는 상황
  - 동기 인터럽트(예외): CPU에 의해 발생하는 인터럽트
  - 비동기 인터럽트(하드웨어 인터럽트): 입출력장치에 의해 발생하는 인터럽트
    1. 입출력 장치 → CPU: 인터럽트 요청 신호
    2. CPU는 인터럽트 요청을 확인하고 인터럽트 플래그를 통해 현재 인터럽트를 받아들일 수 있는지 여부를 확인 (막을 수 있는 인터럽트와 막을 수 없는 인터럽트가 있음)
    3. 가능하다면 지금까지의 작업을 백업하고 인터럽트 벡터(인터럽트 서비스 루틴을 식별하기 위한 정보)를 참조하여 인터럽트 서비스 루틴(인터럽트 핸들러)을 실행

### 예외의 종류
1. 폴트: 예외를 처리한 직후 예외가 발생한 명령어부터 실행을 재개하는 예외
2. 트랩: 예외를 처리한 직후 예외가 발생한 명령어의 다음 명령어부터 실행을 재개하는 예외
3. 중단: CPU가 실행 중인 프로그램을 강제로 중단시킬 수밖에 없는 심각한 오류를 발견했을 때 발생하는 예외
4. 소프트웨어 인터럽트: 시스템 호출이 발생했을 때 
